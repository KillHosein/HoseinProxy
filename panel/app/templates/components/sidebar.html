{% if current_user.is_authenticated %}
<style>
    #sidebar-wrapper {
        min-height: 100vh;
        width: 280px;
        margin-left: -280px;
        transition: margin 0.25s ease-out;
        background: #0f172a; /* رنگ پس‌زمینه هماهنگ با داشبورد */
        border-left: 1px solid rgba(255, 255, 255, 0.05);
        display: flex;
        flex-direction: column;
        z-index: 1000;
        box-shadow: 4px 0 24px rgba(0,0,0,0.2);
    }

    #sidebar-wrapper .sidebar-heading {
        padding: 1.5rem;
        font-size: 1.4rem;
        font-weight: 800;
        color: #fff;
        text-align: center;
        letter-spacing: -0.5px;
        background: linear-gradient(180deg, rgba(30, 41, 59, 0.5) 0%, transparent 100%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        margin-bottom: 1rem;
    }

    .list-group-item {
        background-color: transparent !important;
        color: #94a3b8 !important; /* text-secondary */
        border: none !important;
        padding: 0.9rem 1.5rem;
        font-weight: 500;
        transition: all 0.2s ease;
        border-right: 3px solid transparent !important;
        margin: 4px 12px;
        border-radius: 12px;
        display: flex;
        align-items: center;
    }

    .list-group-item:hover {
        background-color: rgba(255, 255, 255, 0.03) !important;
        color: #f1f5f9 !important;
        transform: translateX(-5px);
    }

    .list-group-item.active {
        background: linear-gradient(90deg, rgba(139, 92, 246, 0.15), rgba(59, 130, 246, 0.05)) !important;
        color: #fff !important;
        border-right-color: #8b5cf6 !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .list-group-item i {
        width: 24px;
        font-size: 1.1rem;
        transition: transform 0.3s;
        opacity: 0.8;
    }

    .list-group-item:hover i, .list-group-item.active i {
        transform: scale(1.15);
        opacity: 1;
        color: #a78bfa; /* رنگ آیکون در حالت فعال */
    }

    .sidebar-footer {
        margin-top: auto;
        padding: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        text-align: center;
        background: linear-gradient(0deg, rgba(30, 41, 59, 0.5) 0%, transparent 100%);
    }

    .telegram-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        padding: 10px;
        background: rgba(56, 189, 248, 0.1);
        color: #38bdf8;
        border: 1px solid rgba(56, 189, 248, 0.2);
        border-radius: 12px;
        text-decoration: none;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: 600;
        font-size: 0.9rem;
    }

    .telegram-btn:hover {
        background: rgba(56, 189, 248, 0.2);
        color: #fff;
        box-shadow: 0 0 20px rgba(56, 189, 248, 0.25);
        transform: translateY(-2px);
        border-color: rgba(56, 189, 248, 0.4);
    }

    /* تنظیم برای حالت ریسپانسیو */
    body.sb-sidenav-toggled #sidebar-wrapper {
        margin-left: 0;
    }
</style>

<div id="sidebar-wrapper">
    <div class="sidebar-heading">
        <i class="fas fa-rocket me-2 text-primary"></i> HoseinProxy
    </div>
    
    <div class="list-group list-group-flush mt-2">
        <a href="{{ url_for('main.dashboard') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'main.dashboard' %}active{% endif %}">
            <i class="fas fa-tachometer-alt me-3"></i> داشبورد
        </a>
        <a href="{{ url_for('reports.index') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'reports.index' %}active{% endif %}">
            <i class="fas fa-chart-pie me-3"></i> گزارشات
        </a>
        <a href="{{ url_for('users.list') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'users.list' %}active{% endif %}">
            <i class="fas fa-users-cog me-3"></i> مدیران
        </a>
        <a href="{{ url_for('firewall.index') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'firewall.index' %}active{% endif %}">
            <i class="fas fa-shield-alt me-3"></i> فایروال
        </a>
        <a href="{{ url_for('system.page') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'system.page' %}active{% endif %}">
            <i class="fas fa-server me-3"></i> سیستم
        </a>
        <a href="{{ url_for('tools.index') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'tools.index' %}active{% endif %}">
            <i class="fas fa-network-wired me-3"></i> ابزارها
        </a>
        <a href="{{ url_for('settings.index') }}" class="list-group-item list-group-item-action {% if request.endpoint == 'settings.index' %}active{% endif %}">
            <i class="fas fa-cogs me-3"></i> تنظیمات
        </a>
        
        <div class="my-2 border-top border-secondary border-opacity-10 mx-4"></div>
        
        <a href="{{ url_for('auth.logout') }}" class="list-group-item list-group-item-action text-danger" style="color: #ef4444 !important;">
            <i class="fas fa-sign-out-alt me-3"></i> خروج
        </a>
    </div>

    <div class="sidebar-footer">
        <a href="https://t.me/HoseinProxy" target="_blank" class="telegram-btn mb-3">
            <i class="fab fa-telegram-plane me-2 fa-lg"></i> پشتیبانی تلگرام
        </a>
        <div class="text-secondary small opacity-50 font-monospace" style="font-size: 0.75rem;">
            Version 3.1.0
        </div>
    </div>
</div>
{% endif %}