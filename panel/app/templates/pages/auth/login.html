<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <!-- تنظیمات ویوپورت برای موبایل: جلوگیری از زوم ناخواسته و تنظیم مقیاس -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>درگاه امنیتی فوق پیشرفته | HoseinProxy Elite</title>
    <!-- Bootstrap 5 RTL -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <!-- Google Fonts -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-void: #030508;
            --panel-bg: rgba(10, 14, 23, 0.9); /* کمی تیره‌تر برای موبایل */
            --border-neon: rgba(0, 242, 254, 0.4);
            --primary: #00f2fe; 
            --secondary: #4facfe;
            --text-main: #e2e8f0;
            --text-dim: #64748b;
            --dev-color: #ff0055;
        }

        * {
            box-sizing: border-box;
            outline: none;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: var(--bg-void);
            margin: 0;
            padding: 0;
            /* استفاده از dvh برای موبایل‌های جدید */
            height: 100vh;
            height: 100dvh; 
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* جلوگیری از اسکرول اضافه */
            position: relative;
            color: var(--text-main);
        }

        /* --- پس‌زمینه شبکه ثابت (Fixed) --- */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at 50% 50%, #0f1521 0%, #000000 100%);
        }

        .global-scan-line {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(90deg, transparent, rgba(0, 242, 254, 0.5), transparent);
            animation: globalScan 8s linear infinite;
            z-index: 1;
            opacity: 0.3;
            pointer-events: none;
        }
        @keyframes globalScan { 0% { top: -10%; } 100% { top: 110%; } }

        /* --- کانتینر اصلی --- */
        .login-wrapper {
            position: relative;
            z-index: 10;
            width: 100%;
            padding: 15px;
            display: flex;
            justify-content: center;
        }

        .login-card {
            background: var(--panel-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-neon);
            /* کلیپ پث فقط در دسکتاپ اعمال شود تا در موبایل فضای زیاد نگیرد */
            clip-path: polygon(
                20px 0, 100% 0, 
                100% calc(100% - 20px), calc(100% - 20px) 100%, 
                0 100%, 0 20px
            );
            padding: 2px;
            box-shadow: 0 0 60px rgba(0, 242, 254, 0.1);
            position: relative;
            width: 100%;
            max-width: 450px;
            transition: transform 0.3s ease;
        }

        .card-inner {
            background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.5));
            clip-path: polygon(
                20px 0, 100% 0, 
                100% calc(100% - 20px), calc(100% - 20px) 100%, 
                0 100%, 0 20px
            );
            padding: 30px 25px; /* پدینگ بهینه شده */
        }

        /* ریسپانسیو برای موبایل */
        @media (max-width: 576px) {
            .login-card, .card-inner {
                clip-path: none; /* حذف گوشه‌های بریده در موبایل برای فضای بیشتر */
                border-radius: 15px;
            }
            .card-inner {
                padding: 25px 20px;
            }
            .brand-title {
                font-size: 1.5rem !important;
            }
            .logo-display {
                width: 60px !important;
                height: 60px !important;
            }
            .logo-icon {
                font-size: 2rem !important;
            }
        }

        /* تزئینات */
        .corner-decor {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary);
            z-index: 12;
            box-shadow: 0 0 10px var(--primary);
        }
        .tl { top: 0; left: 0; }
        .br { bottom: 0; right: 0; }

        /* هدر */
        .brand-section { text-align: center; margin-bottom: 25px; }
        
        .logo-display {
            width: 80px; height: 80px;
            margin: 0 auto 10px;
            position: relative;
            display: flex; align-items: center; justify-content: center;
        }

        .logo-circle {
            position: absolute; width: 100%; height: 100%;
            border: 2px dashed var(--border-neon);
            border-radius: 50%;
            animation: spinSlow 20s linear infinite;
        }

        .logo-icon {
            font-size: 2.5rem; color: var(--primary);
            text-shadow: 0 0 15px var(--primary);
            z-index: 2;
        }
        @keyframes spinSlow { to { transform: rotate(360deg); } }

        .brand-title {
            font-family: 'Share Tech Mono', 'Vazirmatn', monospace;
            font-size: 1.8rem;
            letter-spacing: 1px;
            margin: 0;
            background: linear-gradient(to right, #fff, var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
        }

        .brand-subtitle {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.75rem; color: var(--text-dim);
            letter-spacing: 2px; margin-top: 5px;
        }

        /* ترمینال */
        .ai-terminal {
            background: rgba(0, 0, 0, 0.6);
            border-left: 2px solid var(--primary);
            padding: 8px 12px;
            margin-bottom: 20px;
            font-family: 'Vazirmatn', monospace;
            font-size: 0.8rem;
            display: flex; align-items: center; justify-content: space-between;
            border-radius: 4px;
        }
        .terminal-text { color: #10b981; text-shadow: 0 0 5px rgba(16, 185, 129, 0.4); }
        .ai-refresh {
            background: none; border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-dim); padding: 4px 10px;
            cursor: pointer; transition: 0.3s; font-size: 0.7rem;
            border-radius: 4px;
        }
        .ai-refresh:hover { color: var(--primary); border-color: var(--primary); }

        /* فرم‌ها */
        .cyber-input-group { position: relative; margin-bottom: 15px; }
        
        .cyber-label {
            display: block; font-size: 0.75rem; color: var(--primary);
            margin-bottom: 4px; font-family: 'Share Tech Mono', 'Vazirmatn';
            letter-spacing: 1px; text-transform: uppercase;
        }

        .cyber-input {
            width: 100%;
            background: rgba(5, 10, 20, 0.6);
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            padding: 12px 15px;
            padding-left: 40px;
            font-family: 'Share Tech Mono', sans-serif;
            transition: 0.3s;
            border-radius: 6px;
            font-size: 1rem; /* سایز مناسب برای موبایل (جلوگیری از زوم) */
        }

        .cyber-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(0, 242, 254, 0.2);
            background: rgba(0, 242, 254, 0.05);
        }

        .input-icon {
            position: absolute; left: 12px; bottom: 12px;
            color: var(--text-dim); transition: 0.3s;
        }
        .cyber-input:focus ~ .input-icon { color: var(--primary); }

        /* دکمه */
        .btn-cyber-submit {
            position: relative; width: 100%; padding: 14px;
            background: rgba(0, 242, 254, 0.05);
            border: 1px solid var(--primary);
            color: var(--primary);
            font-family: 'Share Tech Mono', 'Vazirmatn';
            font-size: 1.1rem; font-weight: bold;
            cursor: pointer; overflow: hidden;
            transition: 0.3s; margin-top: 10px;
            text-transform: uppercase; letter-spacing: 2px;
            border-radius: 6px;
        }
        .btn-cyber-submit::before {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 100%; height: 100%; background: var(--primary);
            transition: 0.4s; z-index: -1;
        }
        .btn-cyber-submit:hover { color: #000; box-shadow: 0 0 20px var(--primary); }
        .btn-cyber-submit:hover::before { left: 0; }
        /* استایل تاچ برای موبایل */
        .btn-cyber-submit:active { transform: scale(0.98); }

        /* فوتر */
        .cyber-footer {
            margin-top: 25px; padding-top: 15px;
            border-top: 1px dashed rgba(255,255,255,0.1);
            display: flex; flex-direction: column;
            gap: 15px; align-items: center;
        }

        .dev-badge {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 0, 85, 0.3);
            padding: 8px 25px; /* فضای لمس بیشتر */
            border-radius: 6px;
            text-decoration: none;
            display: flex; align-items: center; gap: 10px;
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .dev-badge:hover, .dev-badge:active {
            border-color: var(--dev-color);
            box-shadow: 0 0 15px rgba(255, 0, 85, 0.3);
        }

        .dev-role {
            font-size: 0.65rem; color: var(--text-dim);
            text-transform: uppercase; letter-spacing: 1px;
            display: block; margin-bottom: 2px;
        }
        .dev-name {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem; color: var(--dev-color);
            font-weight: bold; text-shadow: 0 0 5px rgba(255, 0, 85, 0.5);
        }

        .system-info {
            width: 100%; display: flex; justify-content: space-between;
            font-size: 0.7rem; color: var(--text-dim); font-family: monospace;
        }

        /* هشدارها */
        .alert {
            background: rgba(255, 50, 50, 0.1);
            border-left: 3px solid #ff3232;
            color: #ff8080; font-size: 0.8rem;
            margin-bottom: 15px; padding: 10px;
            border-radius: 4px;
        }

        /* مخفی کردن کیبورد وقتی روی بوم کلیک میشه */
        canvas { touch-action: none; }
    </style>
</head>
<body>

    <canvas id="matrix-canvas"></canvas>
    <div class="global-scan-line"></div>

    <div class="login-wrapper">
        <div class="corner-decor tl d-none d-sm-block"></div>
        <div class="corner-decor br d-none d-sm-block"></div>

        <div class="login-card">
            <div class="card-inner">
                
                <div class="brand-section">
                    <div class="logo-display">
                        <div class="logo-circle"></div>
                        <i class="fas fa-fingerprint logo-icon"></i>
                    </div>
                    <h1 class="brand-title">HoseinProxy</h1>
                    <div class="brand-subtitle">SECURE ACCESS TERMINAL</div>
                </div>

                <div class="ai-terminal">
                    <div>
                        <span style="color:var(--primary); margin-right:5px;">></span>
                        <span id="ai-response" class="terminal-text">System Init... OK</span>
                    </div>
                    <button id="ai-btn" class="ai-refresh">SCAN</button>
                </div>

                {% with messages = get_flashed_messages(with_categories=true) %}
                  {% if messages %}
                    {% for category, message in messages %}
                      <div class="alert alert-{{ category }}">
                        {{ message }}
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endwith %}

                <form method="POST">
                    <div class="cyber-input-group">
                        <label class="cyber-label">User Identifier</label>
                        <input type="text" name="username" class="cyber-input" required autocomplete="off">
                        <i class="fas fa-user-shield input-icon"></i>
                    </div>

                    <div class="cyber-input-group">
                        <label class="cyber-label">Access Token</label>
                        <input type="password" name="password" class="cyber-input" required>
                        <i class="fas fa-key input-icon"></i>
                    </div>

                    <button type="submit" class="btn-cyber-submit">
                        <i class="fas fa-unlock-alt me-2"></i> Authenticate
                    </button>
                </form>

                <div class="cyber-footer">
                    <a href="https://t.me/KillHosein" target="_blank" class="dev-badge">
                        <i class="fas fa-code" style="color:var(--text-dim)"></i>
                        <div>
                            <span class="dev-role">System Architect</span>
                            <span class="dev-name">@KillHosein</span>
                        </div>
                    </a>

                    <div class="system-info">
                        <span id="clock">00:00:00 Z</span>
                        <span>Ver: 3.1.0-M</span>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toISOString().split('T')[1].split('.')[0] + ' Z';
        }
        setInterval(updateClock, 1000);
        updateClock();

        const aiBtn = document.getElementById('ai-btn');
        const aiResponse = document.getElementById('ai-response');
        
        function typeText(element, text, speed = 30) {
            element.innerHTML = "";
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        aiBtn.addEventListener('click', async () => {
            const apiKey = ""; 
            aiResponse.innerText = "Scanning...";
            aiResponse.style.color = "#64748b";
            aiBtn.disabled = true;
            try {
                const genAI = new GoogleGenerativeAI(apiKey);
                const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash-preview-09-2025" });
                const prompt = "Generate a short terminal status: 'ROOT ACCESS: GRANTED'. Max 4 words.";
                const result = await model.generateContent(prompt);
                const text = result.response.text();
                aiResponse.style.color = "#10b981"; 
                typeText(aiResponse, text);
            } catch (error) {
                console.error(error);
                aiResponse.innerText = "LINK ERROR";
                aiResponse.style.color = "#ff3232";
            } finally {
                aiBtn.disabled = false;
            }
        });
    </script>

    <script>
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        let particles = [];
        // اضافه کردن پوزیشن تاچ برای موبایل
        let mouse = { x: null, y: null };

        const config = {
            count: 60,
            color: '#00f2fe',
            lineColor: 'rgba(0, 242, 254, 0.1)',
            radius: 1.5,
            speed: 0.3,
            dist: 130
        };

        // هندل کردن تاچ و موس
        ['mousemove', 'touchmove'].forEach(evt => 
            window.addEventListener(evt, e => {
                if(e.touches) {
                    mouse.x = e.touches[0].clientX;
                    mouse.y = e.touches[0].clientY;
                } else {
                    mouse.x = e.clientX;
                    mouse.y = e.clientY;
                }
            }, {passive: true})
        );
        
        ['mouseleave', 'touchend'].forEach(evt => 
            window.addEventListener(evt, () => { mouse.x = null; mouse.y = null; })
        );

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            // کاهش تعداد ذرات در موبایل برای عملکرد بهتر
            config.count = width < 768 ? 35 : 60;
            config.dist = width < 768 ? 100 : 130;
        }

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.vx = (Math.random() - 0.5) * config.speed;
                this.vy = (Math.random() - 0.5) * config.speed;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                if(this.x < 0 || this.x > width) this.vx *= -1;
                if(this.y < 0 || this.y > height) this.vy *= -1;

                if (mouse.x != null) {
                    let dx = mouse.x - this.x;
                    let dy = mouse.y - this.y;
                    let distance = Math.sqrt(dx*dx + dy*dy);
                    if (distance < 200) {
                        this.x -= dx * 0.02; // کاهش سرعت واکنش برای نرمی بیشتر
                        this.y -= dy * 0.02;
                    }
                }
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, config.radius, 0, Math.PI * 2);
                ctx.fillStyle = config.color;
                ctx.fill();
            }
        }

        function init() {
            particles = [];
            for(let i=0; i<config.count; i++) particles.push(new Particle());
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach((p, i) => {
                p.update();
                p.draw();
                for(let j=i+1; j<particles.length; j++){
                    let p2 = particles[j];
                    let dx = p.x - p2.x;
                    let dy = p.y - p2.y;
                    let d = Math.sqrt(dx*dx + dy*dy);
                    if(d < config.dist){
                        ctx.beginPath();
                        ctx.strokeStyle = `rgba(0, 242, 254, ${1 - d/config.dist})`;
                        ctx.lineWidth = 0.5;
                        ctx.moveTo(p.x, p.y);
                        ctx.lineTo(p2.x, p2.y);
                        ctx.stroke();
                    }
                }
            });
            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', () => { resize(); init(); });
        resize();
        init();
        animate();
    </script>
</body>
</html>